{% extends 'base.html' %}
{% load static %}
{% load editorjs %}

{% block css %}
<link rel="stylesheet" href="{% static 'css/blog_css/blog.css' %}">
{% endblock css%} 

{% block content %}

    {% include 'navbar.html' %}

    <h1>Blogs</h1>
    <a href="{% url 'create_blog' %}" style="color: red;">Create</a>

    {% for blog in blog_list %}
        {% if request.user == blog.author %}
            <a href="{% url 'update_blog' blog.id %}" style="color: red;">Update</a>
            <a href="{% url 'delete_blog' blog.id %}" style="color: red;">Delete</a>
        {% endif %}
        <h2><a href="{{ blog.get_absolute_url }}">{{ blog.blog_title }}</a></h2>
        <small>@{{ blog.author }} | {{ blog.blog_created|timesince }}</small>
        <img src="{{ blog.author.profile_picture.url }}" alt="{{ blog.author }} profile picture">
        <p>{{ blog.blog_body | editorjs }}</p>
        <p style="color: blue;">{{ blog.blog_status }}</p>
        <div>
            <form method="POST">
                {% csrf_token %}
                <button 
                    class="like-button" 
                    hx-post="{% url 'like_blog' blog.id %}" 
                    hx-target="#like_count-{{ blog.pk }}">
                    <svg class="ph-heart" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M22 4C20.8357 4 19.6873 4.27109 18.6459 4.7918C17.6045 5.3125 16.6986 6.06853 16 7C15.0555 5.74071 13.7388 4.8105 12.2363 4.34115C10.7337 3.8718 9.12163 3.8871 7.62829 4.38488C6.13495 4.88266 4.83609 5.83768 3.91568 7.11467C2.99528 8.39166 2.5 9.92588 2.5 11.5C2.5 20.4875 14.9875 27.575 15.5125 27.875C15.6613 27.9586 15.8294 28.0017 16 28C16.1708 28.0029 16.3392 27.9597 16.4875 27.875C18.7871 26.5306 20.944 24.9559 22.925 23.175C27.2875 19.25 29.5 15.325 29.5 11.5C29.5 9.51088 28.7098 7.60322 27.3033 6.1967C25.8968 4.79018 23.9891 4 22 4V4Z" fill="black"/>
                    </svg>
                </button>
                <span id="like_count-{{ blog.pk }}" >{{ blog.blog_likes_count }}</span>
            </form>
        </div>
    {% empty %}
        <h2>No blogs yet</h2>
    {% endfor %}
{% endblock content %}